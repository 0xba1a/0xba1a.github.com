
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Bala">
      
      
        <link rel="canonical" href="https://eastrivervillage.com/blog/archive/2020/">
      
      
        <link rel="prev" href="../2021/">
      
      
        <link rel="next" href="../2019/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../images/fabicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>November 2020 - East River Village</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-3JJ45DK8YN"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-3JJ45DK8YN",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-3JJ45DK8YN",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#november-2020" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://eastrivervillage.com" title="East River Village" class="md-header__button md-logo" aria-label="East River Village" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.41 7.41 15 12l-4.59 4.6L9 15.18 12.18 12 9 8.82M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            East River Village
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              November 2020
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m3.55 19.09 1.41 1.41 1.8-1.79-1.42-1.42M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6c0-3.32-2.69-6-6-6m8 7h3v-2h-3m-2.76 7.71 1.8 1.79 1.41-1.41-1.79-1.8M20.45 5l-1.41-1.4-1.8 1.79 1.42 1.42M13 1h-2v3h2M6.76 5.39 4.96 3.6 3.55 5l1.79 1.81zM1 13h3v-2H1m12 9h-2v3h2"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.5 2c-1.79 1.15-3 3.18-3 5.5s1.21 4.35 3.03 5.5C4.46 13 2 10.54 2 7.5A5.5 5.5 0 0 1 7.5 2m11.57 1.5 1.43 1.43L4.93 20.5 3.5 19.07zm-6.18 2.43L11.41 5 9.97 6l.42-1.7L9 3.24l1.75-.12.58-1.65L12 3.1l1.73.03-1.35 1.13zm-3.3 3.61-1.16-.73-1.12.78.34-1.32-1.09-.83 1.36-.09.45-1.29.51 1.27 1.36.03-1.05.87zM19 13.5a5.5 5.5 0 0 1-5.5 5.5c-1.22 0-2.35-.4-3.26-1.07l7.69-7.69c.67.91 1.07 2.04 1.07 3.26m-4.4 6.58 2.77-1.15-.24 3.35zm4.33-2.7 1.15-2.77 2.2 2.54zm1.15-4.96-1.14-2.78 3.34.24zM9.63 18.93l2.77 1.15-2.53 2.19z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://eastrivervillage.com" title="East River Village" class="md-nav__button md-logo" aria-label="East River Village" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.41 7.41 15 12l-4.59 4.6L9 15.18 12.18 12 9 8.82M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>

    </a>
    East River Village
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.41 7.41 15 12l-4.59 4.6L9 15.18 12.18 12 9 8.82M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.41 7.41 15 12l-4.59 4.6L9 15.18 12.18 12 9 8.82M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../2025/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.41 7.41 15 12l-4.59 4.6L9 15.18 12.18 12 9 8.82M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
  
  <span class="md-ellipsis">
    September 2025
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../2021/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.41 7.41 15 12l-4.59 4.6L9 15.18 12.18 12 9 8.82M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
  
  <span class="md-ellipsis">
    July 2021
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
      
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.41 7.41 15 12l-4.59 4.6L9 15.18 12.18 12 9 8.82M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
  
  <span class="md-ellipsis">
    November 2020
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.41 7.41 15 12l-4.59 4.6L9 15.18 12.18 12 9 8.82M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
  
  <span class="md-ellipsis">
    November 2020
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-perf-with-custom-kernel" class="md-nav__link">
    <span class="md-ellipsis">
      Custom perf with custom kernel
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../2019/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.41 7.41 15 12l-4.59 4.6L9 15.18 12.18 12 9 8.82M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
  
  <span class="md-ellipsis">
    June 2019
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../2018/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.41 7.41 15 12l-4.59 4.6L9 15.18 12.18 12 9 8.82M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
  
  <span class="md-ellipsis">
    October 2018
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../2017/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.41 7.41 15 12l-4.59 4.6L9 15.18 12.18 12 9 8.82M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
  
  <span class="md-ellipsis">
    September 2017
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-perf-with-custom-kernel" class="md-nav__link">
    <span class="md-ellipsis">
      Custom perf with custom kernel
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="november-2020">November 2020</h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="../../../assets/author_image.jpg" alt="Bala">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2020-11-19 18:46:42+00:00">November 19, 2020</time></li>
        
        
          
          <li class="md-meta__item">
            
              6 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="custom-perf-with-custom-kernel"><a class="toclink" href="../../2020/11/19/custom-perf-with-custom-kernel/">Custom perf with custom kernel</a></h2>
<p>There is no doubt that perf is an awesome tool. And eBPF enables us to attach an arbitrary code to any tracepoint. But both has one limitation. They cannot execute a kernel function. As if I want to call a kernel function whenever a tracepoint is hit. Its not possible today. It is not a big caveat. But will be very much useful while debugging kernel.</p>
<p>Lets say I want to trace all IPIs and want to record the source CPU, target CPU. And I want to know whether Idle task was running on the target CPU during the IPI. Inter Processor Interrupt or IPI is and interrupt sent from one CPU to another to wake it up.</p>
<p><strong>NOTE</strong>: <em>All the code referred here is from Linux-5.4.0</em></p>
<p>The code that sends IPI in x86 platform is <code>native_smp_send_reschedule</code>. Below is the code of that function.
<div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">native_smp_send_reschedule</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">cpu</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="n">cpu_is_offline</span><span class="p">(</span><span class="n">cpu</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">WARN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sched: Unexpected reschedule of offline CPU#%d!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cpu</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">apic</span><span class="o">-&gt;</span><span class="n">send_IPI</span><span class="p">(</span><span class="n">cpu</span><span class="p">,</span><span class="w"> </span><span class="n">RESCHEDULE_VECTOR</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
The only argument of this function <code>cpu</code> mentions the target CPU - to which CPU IPI is being sent. I want to source CPU from which the IPI is originates.</p>
<p>To get current CPU kernel has a macro - <code>smp_processor_id()</code>.</p>
<p>We can get the task-run-queue of that CPU using the macro <code>cpu_rq(int cpu)</code>. And <code>cpu_rq(int cpu)-&gt;curr</code> will point to the task that is currently running on that CPU. If that task's <code>pid</code> is 0, it is the Idle task.</p>
<p>So my deduced requirement will be setting and tracepoint on <code>native_smp_send_reschedule</code> and call these kernel functions upon hitting that tracepoint. There is no way today. Thus I'm left with only one option - build my own kernel with necessary modifications.</p>
<h3 id="building-custom-kernel"><a class="toclink" href="../../2020/11/19/custom-perf-with-custom-kernel/#building-custom-kernel">Building custom kernel</a></h3>
<p>I've cloned kernel repository from kernel.org. And checked-out to the desired branch. I'm running Ubuntu-20.05 inside a Virtualbox. So I'm using the kernel-5.4.0 which is already installed in my distribution.
<div class="highlight"><pre><span></span><code>bala@ubuntu-vm-1:~/source/$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git
bala@ubuntu-vm-1:~/source/$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>linux
bala@ubuntu-vm-1:~/source/linux/$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>v5.4.0<span class="w"> </span>v5.4
bala@ubuntu-vm-1:~/source/linux/$<span class="w"> </span>head<span class="w"> </span>-n6<span class="w"> </span>Makefile
<span class="w"> </span><span class="c1"># SPDX-License-Identifier: GPL-2.0</span>
<span class="w"> </span><span class="nv">VERSION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
<span class="w"> </span><span class="nv">PATCHLEVEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>
<span class="w"> </span><span class="nv">SUBLEVEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="w"> </span><span class="nv">EXTRAVERSION</span><span class="w"> </span><span class="o">=</span>
<span class="w"> </span><span class="nv">NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Kleptomaniac<span class="w"> </span>Octopus
bala@ubuntu-vm-1:~/source/linux/$
</code></pre></div></p>
<p>Copied config from current OS. And <code>make oldconfig</code>
<div class="highlight"><pre><span></span><code>bala@ubuntu-vm-1:~/source/linux/$<span class="w"> </span>cp<span class="w"> </span>/boot/config-5.4.0-52-generic<span class="w"> </span>./.config
bala@ubuntu-vm-1:~/source/linux/$<span class="w"> </span>make<span class="w"> </span>oldconfig
</code></pre></div>
If any new configs were, select appropriately if you know it. Otherwise simply ignore it.</p>
<p>Applied following patch.
<div class="highlight"><pre><span></span><code>bala@ubuntu-vm-1:~/source/linux$<span class="w"> </span>git<span class="w"> </span>diff
diff<span class="w"> </span>--git<span class="w"> </span>a/arch/x86/kernel/apic/ipi.c<span class="w"> </span>b/arch/x86/kernel/apic/ipi.c
index<span class="w"> </span>6ca0f91372fd..31df1e1f4922<span class="w"> </span><span class="m">100644</span>
---<span class="w"> </span>a/arch/x86/kernel/apic/ipi.c
+++<span class="w"> </span>b/arch/x86/kernel/apic/ipi.c
@@<span class="w"> </span>-2,6<span class="w"> </span>+2,7<span class="w"> </span>@@

<span class="w"> </span><span class="c1">#include &lt;linux/cpumask.h&gt;</span>
<span class="w"> </span><span class="c1">#include &lt;linux/smp.h&gt;</span>
+#include<span class="w"> </span><span class="s2">&quot;../../../../kernel/sched/sched.h&quot;</span>

<span class="w"> </span><span class="c1">#include &quot;local.h&quot;</span>

@@<span class="w"> </span>-61,14<span class="w"> </span>+62,22<span class="w"> </span>@@<span class="w"> </span>void<span class="w"> </span>apic_send_IPI_allbutself<span class="o">(</span>unsigned<span class="w"> </span>int<span class="w"> </span>vector<span class="o">)</span>
<span class="w">  </span>*<span class="w"> </span>wastes<span class="w"> </span>no<span class="w"> </span><span class="nb">time</span><span class="w"> </span>serializing<span class="w"> </span>anything.<span class="w"> </span>Worst<span class="w"> </span><span class="k">case</span><span class="w"> </span>is<span class="w"> </span>that<span class="w"> </span>we<span class="w"> </span>lose<span class="w"> </span>a
<span class="w">  </span>*<span class="w"> </span>reschedule<span class="w"> </span>...
<span class="w">  </span>*/
+#pragma<span class="w"> </span>GCC<span class="w"> </span>push_options
+#pragma<span class="w"> </span>GCC<span class="w"> </span>optimize<span class="w"> </span><span class="o">(</span><span class="s2">&quot;O0&quot;</span><span class="o">)</span>
<span class="w"> </span>void<span class="w"> </span>native_smp_send_reschedule<span class="o">(</span>int<span class="w"> </span>cpu<span class="o">)</span>
<span class="w"> </span><span class="o">{</span>
+<span class="w">       </span>int<span class="w"> </span><span class="nv">this_cpu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>smp_processor_id<span class="o">()</span><span class="p">;</span>
+<span class="w">       </span>int<span class="w"> </span><span class="nv">that_cpu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>cpu<span class="p">;</span>
+<span class="w">       </span>struct<span class="w"> </span>rq<span class="w"> </span>*rq<span class="w"> </span><span class="o">=</span><span class="w"> </span>cpu_rq<span class="o">(</span>that_cpu<span class="o">)</span><span class="p">;</span>
+<span class="w">       </span>int<span class="w"> </span><span class="nv">is_idle_task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">((</span>rcu_dereference<span class="o">(</span>rq-&gt;curr<span class="o">))</span>-&gt;pid<span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="o">)</span><span class="p">;</span>
+
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">(</span>unlikely<span class="o">(</span>cpu_is_offline<span class="o">(</span>cpu<span class="o">)))</span><span class="w"> </span><span class="o">{</span>
<span class="w">                </span>WARN<span class="o">(</span><span class="m">1</span>,<span class="w"> </span><span class="s2">&quot;sched: Unexpected reschedule of offline CPU#%d!\n&quot;</span>,<span class="w"> </span>cpu<span class="o">)</span><span class="p">;</span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="o">}</span>
<span class="w">        </span>apic-&gt;send_IPI<span class="o">(</span>cpu,<span class="w"> </span>RESCHEDULE_VECTOR<span class="o">)</span><span class="p">;</span>
<span class="w"> </span><span class="o">}</span>
+#pragma<span class="w"> </span>GCC<span class="w"> </span>pop_options

<span class="w"> </span>void<span class="w"> </span>native_send_call_func_single_ipi<span class="o">(</span>int<span class="w"> </span>cpu<span class="o">)</span>
<span class="w"> </span><span class="o">{</span>
diff<span class="w"> </span>--git<span class="w"> </span>a/lib/Kconfig.debug<span class="w"> </span>b/lib/Kconfig.debug
index<span class="w"> </span>93d97f9b0157..706fdfc715ab<span class="w"> </span><span class="m">100644</span>
---<span class="w"> </span>a/lib/Kconfig.debug
+++<span class="w"> </span>b/lib/Kconfig.debug
@@<span class="w"> </span>-359,6<span class="w"> </span>+359,7<span class="w"> </span>@@<span class="w"> </span>config<span class="w"> </span>SECTION_MISMATCH_WARN_ONLY
<span class="w"> </span><span class="c1">#</span>
<span class="w"> </span>config<span class="w"> </span>ARCH_WANT_FRAME_POINTERS
<span class="w">        </span>bool
+<span class="w">       </span>default<span class="w"> </span>y

<span class="w"> </span>config<span class="w"> </span>FRAME_POINTER
<span class="w">        </span>bool<span class="w"> </span><span class="s2">&quot;Compile the kernel with frame pointers&quot;</span>
bala@ubuntu-vm-1:~/source/linux$
</code></pre></div>
This patch contains two changes,
 * <code>lib/Kconfig.debug</code> - It is to enable frame pointers. Frame pointers will be very much useful for stack trace.
 * <code>arch/x86/kernel/apic/ipi.c</code>
     * <code>pragma</code> instructions are compiler directives. They tell GCC not to optimize the code below - <code>O0</code> optimization. Otherwise, GCC may optimize away the variables as they are unused variables.
     * <code>this_cpu</code> is got from <code>smp_processor_id()</code>
     * <code>is_idle_task</code> will be set to 1 if target CPU is executing Idle task.
     * Last <code>pragma</code> instruction is to reset GCC options back to default.</p>
<p>Enabled kernel debug info by setting <code>CONFIG_DEBUG_INFO</code> in the <code>.config</code> file. And built the kernel. My VM has 4 CPUs, so started 8 parallel build threads.
<div class="highlight"><pre><span></span><code>bala@ubuntu-vm-1:~/source/linux$<span class="w"> </span>make<span class="w"> </span>bzImage<span class="w"> </span>-j8
...
...
...
<span class="w">  </span>OBJCOPY<span class="w"> </span>arch/x86/boot/setup.bin
<span class="w">  </span>BUILD<span class="w">   </span>arch/x86/boot/bzImage
Setup<span class="w"> </span>is<span class="w"> </span><span class="m">16412</span><span class="w"> </span>bytes<span class="w"> </span><span class="o">(</span>padded<span class="w"> </span>to<span class="w"> </span><span class="m">16896</span><span class="w"> </span>bytes<span class="o">)</span>.
System<span class="w"> </span>is<span class="w"> </span><span class="m">8097</span><span class="w"> </span>kB
CRC<span class="w"> </span>65acc728
Kernel:<span class="w"> </span>arch/x86/boot/bzImage<span class="w"> </span>is<span class="w"> </span>ready<span class="w">  </span><span class="o">(</span><span class="c1">#1)</span>
bala@ubuntu-vm-1:~/source/linux$
</code></pre></div></p>
<p>Now copied the <code>bzImage</code> to <code>/boot/</code> directory and updated boot loader.
<div class="highlight"><pre><span></span><code>bala@ubuntu-vm-1:~/source/linux$<span class="w"> </span>sudo<span class="w"> </span>cp<span class="w"> </span>arch/x86/boot/bzImage<span class="w"> </span>/boot/vmlinuz-dbg-custom
bala@ubuntu-vm-1:~/source/linux$<span class="w"> </span>sudo<span class="w"> </span>update-grub
Sourcing<span class="w"> </span>file<span class="w"> </span><span class="sb">`</span>/etc/default/grub<span class="s1">&#39;</span>
<span class="s1">Sourcing file `/etc/default/grub.d/init-select.cfg&#39;</span>
Generating<span class="w"> </span>grub<span class="w"> </span>configuration<span class="w"> </span>file<span class="w"> </span>...
dpkg:<span class="w"> </span>warning:<span class="w"> </span>version<span class="w"> </span><span class="s1">&#39;dbg-custom&#39;</span><span class="w"> </span>has<span class="w"> </span>bad<span class="w"> </span>syntax:<span class="w"> </span>version<span class="w"> </span>number<span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>start<span class="w"> </span>with<span class="w"> </span>digit
Found<span class="w"> </span>linux<span class="w"> </span>image:<span class="w"> </span>/boot/vmlinuz-dbg-custom
Found<span class="w"> </span>linux<span class="w"> </span>image:<span class="w"> </span>/boot/vmlinuz-5.4.0-52-generic
Found<span class="w"> </span>initrd<span class="w"> </span>image:<span class="w"> </span>/boot/initrd.img-5.4.0-52-generic
<span class="k">done</span>
bala@ubuntu-vm-1:~/source/linux$
</code></pre></div></p>
<p>Rebooted the VM into newly built kernel.</p>
<h3 id="custom-build-perf"><a class="toclink" href="../../2020/11/19/custom-perf-with-custom-kernel/#custom-build-perf">Custom build perf</a></h3>
<p>As the kernel is custom built, the perf package comes with Ubuntu-20.04 didn't get executed. It threw following error.
<div class="highlight"><pre><span></span><code>bala@ubuntu-vm-1:~/source/linux$<span class="w"> </span>perf<span class="w"> </span>--help
WARNING:<span class="w"> </span>perf<span class="w"> </span>not<span class="w"> </span>found<span class="w"> </span><span class="k">for</span><span class="w"> </span>kernel<span class="w"> </span><span class="m">5</span>.4.0+

<span class="w">  </span>You<span class="w"> </span>may<span class="w"> </span>need<span class="w"> </span>to<span class="w"> </span>install<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>packages<span class="w"> </span><span class="k">for</span><span class="w"> </span>this<span class="w"> </span>specific<span class="w"> </span>kernel:
<span class="w">    </span>linux-tools-5.4.0+-5.4.0+
<span class="w">    </span>linux-cloud-tools-5.4.0+-5.4.0+

<span class="w">  </span>You<span class="w"> </span>may<span class="w"> </span>also<span class="w"> </span>want<span class="w"> </span>to<span class="w"> </span>install<span class="w"> </span>one<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>packages<span class="w"> </span>to<span class="w"> </span>keep<span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>date:
<span class="w">    </span>linux-tools-5.4.0+
<span class="w">    </span>linux-cloud-tools-5.4.0+
bala@ubuntu-vm-1:~/source/linux$
</code></pre></div></p>
<p>So I went ahead and build perf from kernel source itself. Perf requires following packages for adding a probe and source line probing.
 * libelf-dev
 * libdw-dev</p>
<p>I installed both of them.
<div class="highlight"><pre><span></span><code>bala@ubuntu-vm-1:~/source/linux/$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libelf-dev<span class="w"> </span>libdw-dev
</code></pre></div></p>
<p>Now built perf inside the kernel source tree.
<div class="highlight"><pre><span></span><code>bala@ubuntu-vm-1:~/source/linux/$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>tools/perf
bala@ubuntu-vm-1:~/source/linux/tools/perf/$<span class="w"> </span>make
</code></pre></div></p>
<h3 id="running-the-probe-on-custom-kernel-with-custom-perf"><a class="toclink" href="../../2020/11/19/custom-perf-with-custom-kernel/#running-the-probe-on-custom-kernel-with-custom-perf">Running the probe on custom kernel with custom perf</a></h3>
<div class="highlight"><pre><span></span><code>bala@ubuntu-vm-1:~/source/linux/tools/perf$<span class="w"> </span>sudo<span class="w"> </span>./perf<span class="w"> </span>probe<span class="w"> </span>-s<span class="w"> </span>/home/bala/source/linux/<span class="w"> </span>-k<span class="w"> </span>../../vmlinux<span class="w"> </span><span class="nv">native_smp_send_reschedule</span><span class="o">=</span><span class="s2">&quot;native_smp_send_reschedule:7 this_cpu that_cpu is_idle_task&quot;</span>
Added<span class="w"> </span>new<span class="w"> </span>events:
<span class="w">  </span>probe:native_smp_send_reschedule<span class="w"> </span><span class="o">(</span>on<span class="w"> </span>native_smp_send_reschedule:7<span class="w"> </span>with<span class="w"> </span>this_cpu<span class="w"> </span>that_cpu<span class="w"> </span>is_idle_task<span class="o">)</span>
<span class="w">  </span>probe:native_smp_send_reschedule_1<span class="w"> </span><span class="o">(</span>on<span class="w"> </span>native_smp_send_reschedule:7<span class="w"> </span>with<span class="w"> </span>this_cpu<span class="w"> </span>that_cpu<span class="w"> </span>is_idle_task<span class="o">)</span>

You<span class="w"> </span>can<span class="w"> </span>now<span class="w"> </span>use<span class="w"> </span>it<span class="w"> </span><span class="k">in</span><span class="w"> </span>all<span class="w"> </span>perf<span class="w"> </span>tools,<span class="w"> </span>such<span class="w"> </span>as:

<span class="w">        </span>perf<span class="w"> </span>record<span class="w"> </span>-e<span class="w"> </span>probe:native_smp_send_reschedule_1<span class="w"> </span>-aR<span class="w"> </span>sleep<span class="w"> </span><span class="m">1</span>

bala@ubuntu-vm-1:~/source/linux/tools/perf$<span class="w"> </span>sudo<span class="w"> </span>./perf<span class="w"> </span>record<span class="w"> </span>-e<span class="w"> </span>probe:native_smp_send_reschedule_1<span class="w"> </span>-aR<span class="w"> </span>sleep<span class="w"> </span><span class="m">1</span>
Couldn<span class="s1">&#39;t synthesize bpf events.</span>
<span class="s1">[ perf record: Woken up 1 times to write data ]</span>
<span class="s1">way too many cpu caches..[ perf record: Captured and wrote 0.101 MB perf.data (10 samples) ]</span>
<span class="s1">bala@ubuntu-vm-1:~/source/linux/tools/perf$ sudo ./perf report --stdio</span>
<span class="s1"># To display the perf.data header info, please use --header/--header-only options.</span>
<span class="s1">#</span>
<span class="s1">#</span>
<span class="s1"># Total Lost Samples: 0</span>
<span class="s1">#</span>
<span class="s1"># Samples: 10  of event &#39;</span>probe:native_smp_send_reschedule_1<span class="err">&#39;</span>
<span class="c1"># Event count (approx.): 10</span>
<span class="c1">#</span>
<span class="c1"># Overhead  Trace output</span>
<span class="c1"># ........  .......................................................</span>
<span class="c1">#</span>
<span class="w">    </span><span class="m">20</span>.00%<span class="w">  </span><span class="o">(</span>ffffffffa5e46bc9<span class="o">)</span><span class="w"> </span><span class="nv">this_cpu</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">that_cpu</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">is_idle_task</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="m">20</span>.00%<span class="w">  </span><span class="o">(</span>ffffffffa5e46bc9<span class="o">)</span><span class="w"> </span><span class="nv">this_cpu</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="nv">that_cpu</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">is_idle_task</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="m">10</span>.00%<span class="w">  </span><span class="o">(</span>ffffffffa5e46bc9<span class="o">)</span><span class="w"> </span><span class="nv">this_cpu</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">that_cpu</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="nv">is_idle_task</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="m">10</span>.00%<span class="w">  </span><span class="o">(</span>ffffffffa5e46bc9<span class="o">)</span><span class="w"> </span><span class="nv">this_cpu</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">that_cpu</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="nv">is_idle_task</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="m">10</span>.00%<span class="w">  </span><span class="o">(</span>ffffffffa5e46bc9<span class="o">)</span><span class="w"> </span><span class="nv">this_cpu</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">that_cpu</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">is_idle_task</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="m">10</span>.00%<span class="w">  </span><span class="o">(</span>ffffffffa5e46bc9<span class="o">)</span><span class="w"> </span><span class="nv">this_cpu</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="nv">that_cpu</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="nv">is_idle_task</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="m">10</span>.00%<span class="w">  </span><span class="o">(</span>ffffffffa5e46bc9<span class="o">)</span><span class="w"> </span><span class="nv">this_cpu</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="nv">that_cpu</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">is_idle_task</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="m">10</span>.00%<span class="w">  </span><span class="o">(</span>ffffffffa5e46bc9<span class="o">)</span><span class="w"> </span><span class="nv">this_cpu</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="nv">that_cpu</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="nv">is_idle_task</span><span class="o">=</span><span class="m">1</span>


<span class="c1">#</span>
<span class="c1"># (Tip: Skip collecting build-id when recording: perf record -B)</span>
<span class="c1">#</span>
bala@ubuntu-vm-1:~/source/linux/tools/perf$
</code></pre></div>
<p>Why <code>is_idle_task</code> is always 1 during and IPI?! More on later post ;).</p>
<h2 id="references"><a class="toclink" href="../../2020/11/19/custom-perf-with-custom-kernel/#references">References</a></h2>
<ul>
<li>https://github.com/iovisor/bpftrace/issues/792</li>
<li>https://gcc.gnu.org/onlinedocs/gcc/Function-Specific-Option-Pragmas.html</li>
<li>https://news.ycombinator.com/item?id=4711571</li>
<li>https://www.cyberciti.biz/tips/compiling-linux-kernel-26.html</li>
<li>https://tldp.org/LDP/lame/LAME/linux-admin-made-easy/kernel-custom.html</li>
<li>https://stackoverflow.com/questions/28136815/linux-kernel-how-to-obtain-a-particular-version-right-upto-sublevel</li>
<li>https://git-scm.com/docs/git-fetch</li>
<li>https://www.quora.com/How-do-I-compile-a-Linux-perf-tool-with-all-features-For-Linux-4-0-on-Ubuntu</li>
<li>https://serverfault.com/questions/251134/how-to-compile-the-kernel-with-debug-symbols</li>
</ul>
<div class="flex">
        <script src="https://platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script>
        <script type="IN/Share" data-url="https://eastrivervillage.com/blog/2020/11/19/custom-perf-with-custom-kernel/"></script>
    </div>
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <span class="md-pagination__current">1</span> <a class="md-pagination__link" href="page/2/">2</a> <a class="md-pagination__link" href="page/3/">3</a> <span class="md-pagination__dots">..</span> <a class="md-pagination__link" href="page/5/">5</a>
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://www.linkedin.com/in/balakumaran-kannan/" target="_blank" rel="noopener" title="LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/0xba1a" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>